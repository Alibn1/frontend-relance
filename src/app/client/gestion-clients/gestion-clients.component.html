<div class="client-container">
  <app-flash-message *ngIf="showFlash" [message]="flashMessage" [type]="flashType" />
  <div class="top-bar">
    <mat-form-field appearance="outline" class="search-field">
      <mat-label>Rechercher...</mat-label>
      <input matInput (keyup)="applyFilter($event)" placeholder="Rechercher un client...">
      <mat-icon matSuffix>search</mat-icon>
    </mat-form-field>

    <span class="spacer"></span>

    <button mat-raised-button color="primary" (click)="ouvrirFormulaire()">
      + Ajouter un client
    </button>
  </div>


  <table mat-table [dataSource]="dataSource" class="mat-elevation-z2 full-width">

    <ng-container matColumnDef="actions">
      <th mat-header-cell *matHeaderCellDef>Actions</th>
      <td mat-cell *matCellDef="let client">
        <button mat-icon-button color="primary" (click)="remplirFormulaire(client)">
          <mat-icon>edit</mat-icon>
        </button>
        <button mat-icon-button color="warn" (click)="supprimerClient(client.id)">
          <mat-icon>delete</mat-icon>
        </button>
      </td>
    </ng-container>

    <ng-container matColumnDef="code_client">
      <th mat-header-cell *matHeaderCellDef>ID</th>
      <td mat-cell *matCellDef="let client">{{ client.code_client }}</td>
    </ng-container>

    <ng-container matColumnDef="raison_sociale">
      <th mat-header-cell *matHeaderCellDef>Raison sociale</th>
      <td mat-cell *matCellDef="let client">{{ client.raison_sociale }}</td>
    </ng-container>

    <ng-container matColumnDef="email">
      <th mat-header-cell *matHeaderCellDef>Email</th>
      <td mat-cell *matCellDef="let client">{{ client.email }}</td>
    </ng-container>

    <ng-container matColumnDef="telephone">
      <th mat-header-cell *matHeaderCellDef>Téléphone</th>
      <td mat-cell *matCellDef="let client">{{ client.telephone }}</td>
    </ng-container>

    <!-- Adresse -->
    <ng-container matColumnDef="adresse">
      <th mat-header-cell *matHeaderCellDef>Adresse</th>
      <td mat-cell *matCellDef="let client">{{ client.adresse }}</td>
    </ng-container>

    <!-- Ville -->
    <ng-container matColumnDef="ville">
      <th mat-header-cell *matHeaderCellDef>Ville</th>
      <td mat-cell *matCellDef="let client">{{ client.ville }}</td>
    </ng-container>

    <!-- Pays -->
    <ng-container matColumnDef="pays">
      <th mat-header-cell *matHeaderCellDef>Pays</th>
      <td mat-cell *matCellDef="let client">{{ client.pays }}</td>
    </ng-container>

    <!-- Responsable -->
    <ng-container matColumnDef="responsable">
      <th mat-header-cell *matHeaderCellDef>Responsable</th>
      <td mat-cell *matCellDef="let client">{{ client.responsable }}</td>
    </ng-container>

    <!-- Secteur d'activité -->
    <ng-container matColumnDef="secteur_activite">
      <th mat-header-cell *matHeaderCellDef>Secteur</th>
      <td mat-cell *matCellDef="let client">{{ client.secteur_activite }}</td>
    </ng-container>

    <!-- Solde -->
    <ng-container matColumnDef="solde">
      <th mat-header-cell *matHeaderCellDef>Solde</th>
      <td mat-cell *matCellDef="let client">{{ client.solde | number:'1.0-0':'fr-FR' }}</td>
    </ng-container>

    <!-- Encours autorisé -->
    <ng-container matColumnDef="encours_autorise">
      <th mat-header-cell *matHeaderCellDef>Encours</th>
      <td mat-cell *matCellDef="let client">{{ client.encours_autorise | number:'1.0-0':'fr-FR' }}</td>
    </ng-container>

    <!-- Actif -->
    <ng-container matColumnDef="actif">
      <th mat-header-cell *matHeaderCellDef>Actif</th>
      <td mat-cell *matCellDef="let client">
        <mat-icon color="{{ client.actif ? 'primary' : 'warn' }}">
          {{ client.actif ? 'check_circle' : 'cancel' }}
        </mat-icon>
      </td>
    </ng-container>

    <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
    <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
  </table>
</div>
