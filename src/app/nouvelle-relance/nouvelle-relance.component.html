<div class="page-container">
    <!-- Bouton retour -->
    <div class="header-bar">
        <button mat-icon-button color="primary" (click)="goBack()">
            <mat-icon>arrow_back</mat-icon>
        </button>
        <h2>Nouvelle √âtape de Relance</h2>
    </div>

    <!-- ‚úÖ Le FORM englobe les deux cartes -->
    <form [formGroup]="relanceForm" (ngSubmit)="onSubmit()" [class.disabled]="isLoading">

        <div class="cards-grid">
            <!-- üü¶ Carte Informations Relance -->
            <mat-card class="relance-card">
                <mat-card-title class="section-title">Informations relance</mat-card-title>

                <!-- Client -->
                <mat-form-field appearance="outline" class="full-width">
                    <mat-label>Client</mat-label>
                    <input matInput [value]="clientCode + ' - ' + raisonSociale" disabled />
                </mat-form-field>

                <!-- TITRE -->
                <mat-form-field appearance="outline" class="full-width">
                    <mat-label>Titre</mat-label>
                    <input matInput type="text" formControlName="titre" required />
                </mat-form-field>

                <!-- ORDRE -->
                <mat-form-field appearance="outline" class="full-width">
                    <mat-label>Ordre</mat-label>
                    <input matInput type="number" formControlName="ordre" required />
                </mat-form-field>

                <!-- DATE -->
                <mat-form-field appearance="outline" class="full-width">
                    <mat-label>Date Rappel</mat-label>
                    <input matInput [matDatepicker]="picker" formControlName="date_rappel" required />
                    <mat-datepicker-toggle matSuffix [for]="picker"></mat-datepicker-toggle>
                    <mat-datepicker #picker></mat-datepicker>
                </mat-form-field>

                <!-- NOMBRE DE JOURS -->
                <mat-form-field appearance="outline" class="full-width">
                    <mat-label>Nombre de jours</mat-label>
                    <mat-select formControlName="nb_jours_rappel" required>
                        <mat-option [value]="30">30 jours</mat-option>
                        <mat-option [value]="60">60 jours</mat-option>
                        <mat-option [value]="90">90 jours</mat-option>
                        <mat-option [value]="120">120 jours</mat-option>
                    </mat-select>
                </mat-form-field>

                <!-- METHODE -->
                <mat-form-field appearance="outline" class="full-width">
                    <mat-label>M√©thode d'envoi</mat-label>
                    <mat-select formControlName="methode_envoi" required>
                        <mat-option value="Email">Email</mat-option>
                        <mat-option value="Courrier">Courrier</mat-option>
                        <mat-option value="T√©l√©phone">T√©l√©phone</mat-option>
                    </mat-select>
                </mat-form-field>

                <!-- OBSERVATIONS -->
                <mat-form-field appearance="outline" class="full-width">
                    <mat-label>Observation 1</mat-label>
                    <textarea matInput formControlName="objet_relance1"></textarea>
                </mat-form-field>

                <mat-form-field appearance="outline" class="full-width">
                    <mat-label>Observation 2</mat-label>
                    <textarea matInput formControlName="objet_relance2"></textarea>
                </mat-form-field>
            </mat-card>

            <!-- üü© Carte Mod√®le Relance -->
            <mat-card class="relance-card">
                <mat-card-title class="section-title">Mod√®le relance</mat-card-title>

                <mat-form-field appearance="outline" class="full-width">
                    <mat-label>Choisir un mod√®le</mat-label>
                    <mat-select formControlName="modele_relance" required>
                        <mat-option value="Relance 1 - Amiable">Relance 1 - Amiable</mat-option>
                        <mat-option value="Relance 2 - Serieux">Relance 2 - S√©rieux</mat-option>
                        <mat-option value="Relance 3 - Demeure">Relance 3 - Demeure</mat-option>
                    </mat-select>
                </mat-form-field>
            </mat-card>
        </div>

        <!-- Boutons -->
        <div class="button-group">
            <button mat-raised-button color="primary" type="submit" [disabled]="isLoading">
                <mat-icon *ngIf="!isLoading">save</mat-icon>
                <span *ngIf="!isLoading">Enregistrer</span>
                <span *ngIf="isLoading">Enregistrement...</span>
            </button>

            <button mat-stroked-button type="button" (click)="cancel()">Annuler</button>
        </div>

    </form>
</div>
